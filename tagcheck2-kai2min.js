!function(e){function t(e){for(var t=0;t<o.length;t++){var n=o[t];if(n.head<=e&&e<n.tail)return!0;if(e<n.head)break}return!1}if(function(){var e=document.body.lastChild;"SCRIPT"==e.tagName&&"tagcheck-script"==e.id&&document.body.removeChild(e)}(),e){!function(){var t=e.document;t.open();var n=["<html>","<head>","<title>tagcheck result</title>",'<style type="text/css">',"* {font-size:10pt;margin:0;padding:0;font-family:sans-serif;}","h1 {background:#339; padding:5px; color:white}","ol li{margin-left:30px;}","#loading {padding:3em;text-align:center;background-image:url(loading.gif);background-repeat:no-repeat;","background-position:center center;height:100px;}","#summary {margin:10px;padding:1em; color:#660;font-weight:bold;}","#list {margin:10px;padding:1em; background:#eee;border:1px solid gray} ","#source{margin:10px;padding:3px;border:1px solid gray;background:#eee;}",".ln{background:white;width:30px;border-right:4px solid #9999cc;float:left;clear:both;padding-right:4px;text-align:right;margin-right:4px;}",".error{color:white;background:orange;font-weight:demi;}",".error a:link {text-decoration:none;}","a:focus {background:red;}",".success{border: 1px solid green;background:#ccffcc}",".fail{border:1px solid red;background:#ffcccc}",".show{display:block;}",".none{display:none;}",".o{background:#fbe7b6;}",".e{background:#ead6a5;}","</style>","</head>","<body>",'<div id="loading">now computing...',"</div>",'<div id="resultarea" class="none">',"<h1>チェック結果概要</h1>",'<div id="summary"></div>',"<h1>タグ対応エラー一覧</h1>",'<div id="list"></div>',"<h1>HTMLソース</h1>",'<div id="source"></div>','<div id="debug"></div>',"</div>","</body>","</html>"];t.write(n.join("\n")),t.close();var a=function(t){return e.document.getElementById(t)},r=function(e){var t=document.documentElement,n=e.getBoundingClientRect(),a=n.left-t.clientLeft,r=n.top-t.clientTop;return{left:a,top:r}};return e.showResult=function(e,t,n){var r=a("loading");r.parentNode.removeChild(r);var i=n.length;!function(){var e=a("summary"),t=0==i?"素晴らしい！とりあえずタグの対応だけは完璧です！":1==i?"惜しい！1個だけきちんと対応していないタグがあります。":"残念、"+i+"個のタグがきちんと対応していません。";e.innerHTML=t,e.className=i?"fail":"success"}(),function(){var t=1,r=function(e){return e.replace(/[<>&\r\n \t]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"\r":return"";case"\n":var n=t%2==0?"e":"o";return'</div>\n<div class="ln">'+ ++t+'</div><div class="'+n+'">&nbsp;';case"	":return"&nbsp;&nbsp;&nbsp;&nbsp;";case" ":return"&nbsp;"}})},i=['<div class="ln">1</div><div class="e">&nbsp;'];n.sort(function(e,t){return e.head-t.head});for(var o=0,l=0,s=n.length;s>l;l++){var d=n[l];if(o<d.tail){var c=r(e.substring(o,d.head)),u=r(e.substring(d.head,d.tail));i.push(c,'<span class="error">','<a id = "a'+d.id+'"',' title="'+d.message+'"'," href=\"javascript:go('d"+d.id+"');\">",u,"</a></span>"),d.lineNumber=t,o=d.tail}}i.push(r(e.substring(o)),'<br clear="all">');var g=a("source");g.innerHTML=i.join("")}(),function(){for(var e=["<ol>"],t=0,r=n.length;r>t;t++){var i=n[t];e.push("<li>","("+i.lineNumber+"行目) ",'<a id="d'+i.id+'"'," href=\"javascript:go('a"+i.id+"');\">&lt;",i.tagName+i.attr,"&gt;</a> : ",i.message,"</li>")}e.push("</ol>"),a("list").innerHTML=e.join("")}(),a("resultarea").className="show"},e.go=function(t){var n=(e.scrollY||0,a(t));n.focus();var i=(e.scrollY||0,e.innerHeight),o=r(n).top,l=50;l>o?e.scrollBy(0,-i/2):o>i-l&&e.scrollBy(0,i/2)},e}();var n=function(){var e=function(){try{return window.XMLHttpRequest?new XMLHttpRequest:ActiveXObject?new ActiveXObject("Msxml2.XMLHTTP"):null}catch(e){return new ActiveXObject("Microsoft.XMLHTTP")}}();return e.open("GET",location.href,!1),e.send(""),e.responseText}(),a={},r={},i=[],o=[],l=["img","link","meta","br","hr","input","embed","area","base","basefont","bgsound","param","wbr","col","source","track","li"];l.indexOf=l.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]==e)return t;return-1},function(){for(var e=/(<script[^>]*>[\s\S]*?<\/script>)|(<\!--[\s\S]*?-->)/gim,t=null;t=e.exec(n);){var a=t.index,r=a+t[0].length;o.push({head:a,tail:r}),e.lastIndex=r}}(),function(){for(var e=function(e,t,n){var a=new RegExp("<(/)?"+n+"( [^>]*)?>","igm");a.lastIndex=t;for(var i=1,o=null;o=a.exec(e);)if("/"==o[1]){if(0==--i)return r[o.index]?!1:{head:o.index,tail:o.index+o[0].length}}else i++;return!1},o=/<([a-zA-Z1-9:]+)([^>]*)>/gm,s=null;s=o.exec(n);)if(!t(s.index)){var d=s.index,c=d+s[0].length,u=s[1].toLowerCase(),g=s[2];if(l.indexOf(u)>=0||g&&"/"==g.charAt(g.length-1))r[d]={open:d,openTail:c,close:d,closeTail:c,tagName:u,attr:g};else{var h=e(n,c,u);h?a[d]=r[h.head]={open:d,openTail:c,close:h.head,closeTail:h.tail,tagName:u,attr:g}:i.push({id:i.length,head:d,tail:c,tagName:u,attr:g,message:"タグが閉じていません"})}o.lastIndex=c}}(),function(){for(var e=/<\/([a-zA-Z1-9:]+)>/gm,a=null;a=e.exec(n);)if(!t(a.index)){var o=a.index,s=o+a[0].length,d=a[1].toLowerCase(),c="";l.indexOf(d)<0&&(r[a.index]||i.push({id:i.length,head:o,tail:s,tagName:"/"+d,attr:c,message:"開きタグがありません"})),e.lastIndex=s}}(),function(){var e=[];for(var t in a){for(var n=a[t],r=e.length-1;r>=0;r--){var o=e[r];o.open<n.open&&n.open<o.close&&o.close<n.close?(i.push({id:i.length,head:o.close,tail:o.closeTail,tagName:"/"+o.tagName,attr:"",message:"&lt;"+n.tagName+n.attr+"&gt;よりも先に閉じてしまっています"}),i.push({id:i.length,head:n.close,tail:n.closeTail,tagName:"/"+n.tagName,attr:"",message:"&lt;"+o.tagName+o.attr+"&gt;よりも後で閉じてしまっています"})):o.close<n.open&&e.splice(r,1)}e.push(n)}}(),e.showResult(n,r,i)}}(w);